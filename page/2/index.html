<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.4.2" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.2">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.2" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.4.2',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Ewkoll">
<meta property="og:url" content="/page/2/index.html">
<meta property="og:site_name" content="Ewkoll">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ewkoll">






  <link rel="canonical" href="/page/2/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Ewkoll</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ewkoll</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/12/20/Java字节码-class文件结构/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/20/Java字节码-class文件结构/" itemprop="url">
                  Java字节码(.class文件结构)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-20 11:11:02 / 修改时间：15:54:45" itemprop="dateCreated datePublished" datetime="2018-12-20T11:11:02+08:00">2018-12-20</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简单记录-Class文件结构"><a href="#简单记录-Class文件结构" class="headerlink" title="简单记录.Class文件结构"></a>简单记录.Class文件结构</h2><h3 id="ClassFile总体结构"><a href="#ClassFile总体结构" class="headerlink" title="ClassFile总体结构"></a>ClassFile总体结构</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ClassFile &#123;</span><br><span class="line">    u4             magic;</span><br><span class="line">    u2             minor_version;</span><br><span class="line">    u2             major_version;</span><br><span class="line">    u2             constant_pool_count;</span><br><span class="line">    cp_info        constant_pool[constant_pool_count<span class="number">-1</span>];</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             this_class;</span><br><span class="line">    u2             super_class;</span><br><span class="line">    u2             interfaces_count;</span><br><span class="line">    u2             interfaces[interfaces_count];</span><br><span class="line">    u2             fields_count;</span><br><span class="line">    field_info     fields[fields_count];</span><br><span class="line">    u2             methods_count;</span><br><span class="line">    method_info    methods[methods_count];</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li><p>magic</p>
<blockquote>
<p>标识是否是class文件，正常class文件开头都是4个字节0xCAFEBABE.</p>
</blockquote>
</li>
<li><p>minor_version major_version</p>
<blockquote>
<p>编译成class文件的版本号，java6编译的major_version是0x32.</p>
</blockquote>
</li>
<li><p>constant_pool_count</p>
<blockquote>
<p>常量池的数量。</p>
</blockquote>
</li>
<li><p>constant_pool</p>
<blockquote>
<p>常量池，用于存放不同类型的数据，各种字符串，变量名称，变量类型都会存储在常量池。</p>
</blockquote>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp_info &#123;</span><br><span class="line">    u1 tag;</span><br><span class="line">    u1 info[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> | Constant Type                 | Value |<br> | —————————– | —– |<br> | CONSTANT_Class                |   7   |<br> | CONSTANT_Fieldref             |   9   |<br> | CONSTANT_Methodref            |   10  |<br> | CONSTANT_InterfaceMethodref   |   11  |<br> | CONSTANT_String               |   8   |<br> | CONSTANT_Integer              |   3   |<br> | CONSTANT_Float                |   4   |<br> | CONSTANT_Long                 |   5   |<br> | CONSTANT_Double               |   6   |<br> | CONSTANT_NameAndType          |   12  |<br> | CONSTANT_Utf8                 |   1   |<br> | CONSTANT_MethodHandle         |   15  |<br> | CONSTANT_MethodType           |   16  |<br> | CONSTANT_InvokeDynamic        |   18  |</p>
</li>
<li><p>access_flags</p>
<blockquote>
<p>指定接口和类的访问权限。</p>
</blockquote>
<p> | Flag Name     | Value     | Interpretation                                       |<br> | ————- | ———-| —————————————————–|<br> | ACC_PUBLIC    | 0x0001    | 公共，可以被外部包访问。                               |<br> | ACC_FINAL     | 0x0010    | 不允许继承.                                           |<br> | ACC_SUPER     | 0x0020    | 当被invoke.指令调用时,要特别对待超类方法。              |<br> | ACC_INTERFACE | 0x0200    | 接口类。                                              |<br> | ACC_ABSTRACT  | 0x0400    | 抽象类，不能实例化。                                   |<br> | ACC_SYNTHETIC | 0x1000    | 编译器生成，不在源代码中。                             |<br> | ACC_ANNOTATION| 0x2000    | 注解类型。                                            |<br> | ACC_ENUM      | 0x4000    | 枚举类型。                                            |</p>
</li>
<li><p>this_class</p>
<blockquote>
<p>指向的是在静态区的CONSTANT_class_info结构体，说明当前的类名称。</p>
</blockquote>
</li>
<li><p>super_class</p>
<blockquote>
<p>0 或者 指向的是在静态区的CONSTANT_class_info结构体，说明当前的父类名称。</p>
</blockquote>
</li>
<li><p>interfaces_count</p>
<blockquote>
<p>说明接口的数量</p>
</blockquote>
</li>
<li><p>interfaces</p>
<blockquote>
<p>指向CONSTANT_class_info数组，记录当前类的实现接口。</p>
</blockquote>
</li>
<li><p>fields_count</p>
<blockquote>
<p>字段数量</p>
</blockquote>
</li>
<li><p>fields</p>
<blockquote>
<p>字段信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">field_info &#123;</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             name_index;</span><br><span class="line">    u2             descriptor_index;</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>| Flag Name     | Value     | Interpretation                             |<br>| ————- | ——— | —————————————— |<br>| ACC_PUBLIC    | 0x0001    | pubilc，包外可访问。                        |<br>| ACC_PRIVATE   | 0x0002    | private，只可在类内访问。                    |<br>| ACC_PROTECTED | 0x0004    | protected，类内和子类中可访问。              |<br>| ACC_STATIC    | 0x0008    | static. 静态。                              |<br>| ACC_FINAL     | 0x0010    | final. 常量。                               |<br>| ACC_VOLATILE  | 0x0040    | 易变类型。                                  |<br>| ACC_TRANSIENT | 0x0080    | 序列化忽略。                                |<br>| ACC_SYNTHETIC | 0x1000    | 编译器产生。                                |<br>| ACC_ENUM      | 0x4000    | 枚举类型。                                  |</p>
</li>
<li><p>methods_count</p>
<blockquote>
<p>方法数量</p>
</blockquote>
</li>
<li><p>methods</p>
<blockquote>
<p>方法信息。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">method_info &#123;</span><br><span class="line">    u2             access_flags;</span><br><span class="line">    u2             name_index;</span><br><span class="line">    u2             descriptor_index;</span><br><span class="line">    u2             attributes_count;</span><br><span class="line">    attribute_info attributes[attributes_count];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>| Flag Name         | Value     | Interpretation    |<br>| -                 | -         | -                 |<br>| ACC_PUBLIC        | 0x0001    | 公共方法<br>| ACC_PRIVATE       | 0x0002    | 私有方法<br>| ACC_PROTECTED     | 0x0004    | 保护方法<br>| ACC_STATIC        | 0x0008    | 静态方法<br>| ACC_FINAL         | 0x0010    | 不允许重写<br>| ACC_SYNCHRONIZED  | 0x0020    | Declared  synchronized; invocation is wrapped by a monitor use.<br>| ACC_BRIDGE        | 0x0040    | 编译器生成<br>| ACC_VARARGS       | 0x0080    | 可变参数<br>| ACC_NATIVE        | 0x0100    | Native方法<br>| ACC_ABSTRACT      | 0x0400    | 抽象方法<br>| ACC_STRICT        | 0x0800    | 浮点数模型2.8.2<br>| ACC_SYNTHETIC     | 0x1000    | 编译器生成方法</p>
</li>
<li><p>attributes_count</p>
<blockquote>
<p>属性数量</p>
</blockquote>
</li>
<li><p>attributes</p>
<blockquote>
<p>属性信息</p>
</blockquote>
</li>
</ol>
<h3 id="静态区结构体"><a href="#静态区结构体" class="headerlink" title="静态区结构体"></a>静态区结构体</h3><ol>
<li><p>CONSTANT_Class_info 代表接口或者类</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Class_info &#123;</span><br><span class="line">    u1 tag; // 7</span><br><span class="line">    u2 name_index; // 指向静态区的CONSTANT_Utf8_info存储名称。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_Fieldref_info 用于记录字段信息 </p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Fieldref_info &#123;</span><br><span class="line">    u1 tag; // 9</span><br><span class="line">    u2 class_index; // 指向的可能是classtype或者interfacetype</span><br><span class="line">    u2 name_and_type_index; // 指向 CONSTANT_NameAndType_info 字段描述或者方法描述</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_Methodref_info 用于记录方法信息</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Methodref_info &#123;</span><br><span class="line">    u1 tag; // 10</span><br><span class="line">    u2 class_index; // classtype</span><br><span class="line">    u2 name_and_type_index; // 如果是&lt;开始的，那么一定是void &lt;init&gt;的方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_InterfaceMethodref_info 用于记录接口中的方法信息</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_InterfaceMethodref_info &#123;</span><br><span class="line">    u1 tag; // 11</span><br><span class="line">    u2 class_index; // interfacetype</span><br><span class="line">    u2 name_and_type_index; // 指向 CONSTANT_NameAndType_info 字段描述或者方法描述</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_String_info 记录字符串。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_String_info &#123;</span><br><span class="line">    u1 tag; // 8 </span><br><span class="line">    u2 string_index; // 指向CONSTANT_Utf8_info</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_Integer_info 记录Int类型常量</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Integer_info &#123;</span><br><span class="line">    u1 tag; // 3</span><br><span class="line">    u4 bytes; // 整型常量</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_Float_info 记录浮点数常量</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Float_info &#123;</span><br><span class="line">    u1 tag; // 4</span><br><span class="line">    u4 bytes; // 浮点常量</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 几个特殊值：</p>
<p> 0x7f800000 =&gt; Float.POSITIVE_INFINITY </p>
<p> 0xff800000 =&gt; Float.NEGATIVE_INFINITY</p>
<p> 0x7f800001 to 0x7fffffff =&gt; Float.NaN</p>
<p> 0xff800001 to 0xffffffff =&gt; Float.NaN</p>
<ol start="8">
<li><p>CONSTANT_Long_info 记录long类型常量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Long_info &#123;</span><br><span class="line">    u1 tag; // 5</span><br><span class="line">    u4 high_bytes; // 高4位</span><br><span class="line">    u4 low_bytes;  // 低4位</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>CONSTANT_Double_info 记录Double类型常量</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Double_info &#123;</span><br><span class="line">    u1 tag; // 6</span><br><span class="line">    u4 high_bytes;  // 双精度浮点的高四位值</span><br><span class="line">    u4 low_bytes;   // 双精度浮点的低四位值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 几个特殊值：</p>
<p> 0x7ff0000000000000L =&gt; Double.POSITIVE_INFINITY</p>
<p> 0xfff0000000000000L =&gt; Double.NEGATIVE_INFINITY</p>
<p> 0x7ff0000000000001L to 0x7fffffffffffffffL =&gt; Double.NaN</p>
<p> 0xfff0000000000001L to 0xffffffffffffffffL =&gt; Double.NaN</p>
</li>
<li><p>CONSTANT_NameAndType_info 记录方法或字段的名称(name)和描述符(descriptor)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_NameAndType_info &#123;</span><br><span class="line">    u1 tag; // 12</span><br><span class="line">    u2 name_index; // CONSTANT_Utf8_info </span><br><span class="line">    u2 descriptor_index; // CONSTANT_Utf8_info </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_Utf8_info 记录字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_Utf8_info &#123;</span><br><span class="line">    u1 tag; // 1</span><br><span class="line">    u2 length; // 长度</span><br><span class="line">    u1 bytes[length]; // 字符串数据。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_MethodHandle_info 代表方法句柄</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_MethodHandle_info &#123;</span><br><span class="line">    u1 tag; // 15 </span><br><span class="line">    u1 reference_kind; // 1-9的值</span><br><span class="line">    u2 reference_index; // 不同的reference_kind值有不同的行为。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_MethodType_info</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_MethodType_info &#123;</span><br><span class="line">    u1 tag; // 16</span><br><span class="line">    u2 descriptor_index; // CONSTANT_Utf8_info</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CONSTANT_InvokeDynamic_info</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CONSTANT_InvokeDynamic_info &#123;</span><br><span class="line">    u1 tag; // 17</span><br><span class="line">    u2 bootstrap_method_attr_index;</span><br><span class="line">    u2 name_and_type_index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/29/Spark相关/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/Spark相关/" itemprop="url">
                  Spark相关
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-29 15:06:37 / 修改时间：15:23:40" itemprop="dateCreated datePublished" datetime="2018-11-29T15:06:37+08:00">2018-11-29</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ol>
<li><p>每个Spark的作业都是一个Application。</p>
</li>
<li><p>每个Application中对应的多个Jobs。</p>
</li>
<li><p>一个Action操作会触发一个job。（Count，Collect这类）</p>
</li>
<li><p>每个Job会拆分成多个Stage。（发生shuffle拆分一个stage）</p>
</li>
<li><p>reduceByKey操作会发生shuffle</p>
</li>
</ol>
<h3 id="任务并行度配置"><a href="#任务并行度配置" class="headerlink" title="任务并行度配置"></a>任务并行度配置</h3><ol>
<li>目前存在2个Executor，总共有20个CPU核心，那么分配的任务数量=20*2.5，即大约50个即可。</li>
</ol>
<h3 id="什么是Shuffle"><a href="#什么是Shuffle" class="headerlink" title="什么是Shuffle"></a>什么是Shuffle</h3>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/29/记录一次SparkStream中Processing-Time时间过长的问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/29/记录一次SparkStream中Processing-Time时间过长的问题/" itemprop="url">
                  记录一次SparkStream中Processing Time时间过长的问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-29 14:20:58 / 修改时间：14:32:15" itemprop="dateCreated datePublished" datetime="2018-11-29T14:20:58+08:00">2018-11-29</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题的起因很简单，Spark-Stream执行的批任务堆积。"><a href="#问题的起因很简单，Spark-Stream执行的批任务堆积。" class="headerlink" title="问题的起因很简单，Spark Stream执行的批任务堆积。"></a>问题的起因很简单，Spark Stream执行的批任务堆积。</h2><h3 id="第一次排查"><a href="#第一次排查" class="headerlink" title="第一次排查"></a>第一次排查</h3><ul>
<li><p>通过UI查看了时间消耗问题。发现主要是在代码中执行saveToEs的时候花费了非常的时间。</p>
</li>
<li><p>查看网络连接，发现通信端存在大量的TIME_WAIT状态的连接。</p>
   <img src="/2018/11/29/记录一次SparkStream中Processing-Time时间过长的问题/time_wait.png">
<ul>
<li><p>图片显示的数值是调整了访问2个ES节点地址之后的结果，只访问一个的时候会存在1W多个这样的连接状态。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysctl.conf</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_syncookies = 1</span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line">net.ipv4.tcp_tw_recycle = 1</span><br><span class="line">net.ipv4.tcp_fin_timeout = 30</span><br><span class="line"></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>针对这个情况，暂时没有找到解决的办法，只能推测saveToEsWithMeta这样的函数内部是HTTP短连接每次都会建立新的TCP连接到ES服务器。（还没看源码！）</p>
</li>
</ul>
<h3 id="第二次排查"><a href="#第二次排查" class="headerlink" title="第二次排查"></a>第二次排查</h3><ul>
<li>针对ES提供的库暂时改不了的情况，寻求其它解决办法。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/26/ES常见问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/26/ES常见问题/" itemprop="url">
                  ES常见问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-26 11:07:10 / 修改时间：11:16:11" itemprop="dateCreated datePublished" datetime="2018-11-26T11:07:10+08:00">2018-11-26</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>ES写入数据可能会出现FORBIDDEN/12/index read-only / allow delete (api)]错误</p>
  <img src="/2018/11/26/ES常见问题/es.png">
<p>  <a href="https://discuss.elastic.co/t/forbidden-12-index-read-only-allow-delete-api/110282/3" target="_blank" rel="noopener">相关链接</a></p>
<p>  这个问题是因为ES的存储空间不够，导致写入数据失败。</p>
<p>  1、调整存储的磁盘空间。然后重启ES程序。</p>
<p>  2、执行以下代码。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PUT _settings</span><br><span class="line">&#123;</span><br><span class="line">    &quot;index&quot;: &#123;</span><br><span class="line">        &quot;blocks&quot;: &#123;</span><br><span class="line">        &quot;read_only_allow_delete&quot;: &quot;false&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/12/Hadoop常见异常/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/12/Hadoop常见异常/" itemprop="url">
                  Hadoop常见异常
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-12 09:50:52" itemprop="dateCreated datePublished" datetime="2018-11-12T09:50:52+08:00">2018-11-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2018-11-29 14:18:33" itemprop="dateModified" datetime="2018-11-29T14:18:33+08:00">2018-11-29</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="服务器异常断电的情况下，重启Hadoop会提示块异常进入安全模式。"><a href="#服务器异常断电的情况下，重启Hadoop会提示块异常进入安全模式。" class="headerlink" title="服务器异常断电的情况下，重启Hadoop会提示块异常进入安全模式。"></a>服务器异常断电的情况下，重启Hadoop会提示块异常进入安全模式。</h3><ol>
<li><p>先执行 hdfs dfsadmin -safemode leave 退出安全模式。</p>
</li>
<li><p>后执行 hdfs fsck /logminer/checkpoint/172.17.0.4_12a69c556cad 查看损坏的块。</p>
</li>
<li><p>后执行 hdfs fsck -delete /logminer/checkpoint/172.17.0.4_12a69c556cad 对应的块数据。</p>
</li>
</ol>
<h3 id="意外删除副本机器上的Hadoop数据目录解决版本"><a href="#意外删除副本机器上的Hadoop数据目录解决版本" class="headerlink" title="意外删除副本机器上的Hadoop数据目录解决版本"></a>意外删除副本机器上的Hadoop数据目录解决版本</h3><ol>
<li><p>先从正常的机器拷贝Datanode节点数据到删除的副本机器上。</p>
</li>
<li><p>停止在直接启动集群，会出现以下错误。</p>
 <img src="/2018/11/12/Hadoop常见异常/storageid_error.png">
</li>
<li><p>修改/home/hadoop/data/dfs/datanode/current/VERSION文件的datanodeUuid，只要改一位就可以。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/08/GO加密模块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/08/GO加密模块/" itemprop="url">
                  GO加密模块
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-08 15:40:29 / 修改时间：18:43:18" itemprop="dateCreated datePublished" datetime="2018-11-08T15:40:29+08:00">2018-11-08</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常见模块"><a href="#常见模块" class="headerlink" title="常见模块"></a>常见模块</h2><h3 id="Keyed-Hash-Message-Authentication-Code-密钥哈希消息认证码"><a href="#Keyed-Hash-Message-Authentication-Code-密钥哈希消息认证码" class="headerlink" title="Keyed-Hash Message Authentication Code 密钥哈希消息认证码"></a>Keyed-Hash Message Authentication Code 密钥哈希消息认证码</h3><ul>
<li><p>HMac 使用密钥对消息签名的算法。</p>
<p>  这个算法，就是在计算哈希的时候，嵌入一个密钥，对MD5,SHA算法都有用，本质上这个算法，就是提供一个SHA(message + salt)的通用计算公式。</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">hmacSign</span><span class="params">(key <span class="keyword">string</span>, message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    mac := hmac.New(md5.New, []<span class="keyword">byte</span>(key))</span><br><span class="line">    mac.Write([]<span class="keyword">byte</span>(message))</span><br><span class="line">    expectedMAC := mac.Sum(<span class="literal">nil</span>)</span><br><span class="line">    fmt.Println(hex.EncodeToString(expectedMAC))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="哈希计算-MD5"><a href="#哈希计算-MD5" class="headerlink" title="哈希计算 MD5"></a>哈希计算 MD5</h3><ul>
<li>这个没什么说的，不建议使用的方法。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算字符串MD5</span></span><br><span class="line">data := []<span class="keyword">byte</span>(<span class="string">"These pretzels are making me thirsty."</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%x"</span>, md5.Sum(data))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算字符串MD5</span></span><br><span class="line">h := md5.New()</span><br><span class="line">h.Write([]<span class="keyword">byte</span>(<span class="string">"These pretzels are making me thirsty."</span>))</span><br><span class="line">io.WriteString(h, <span class="string">"The fog is getting thicker!"</span>)</span><br><span class="line">io.WriteString(h, <span class="string">"And Leon's getting laaarger!"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"%x"</span>, h.Sum(<span class="literal">nil</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算文件MD5</span></span><br><span class="line">f, err := os.Open(<span class="string">"file.txt"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line">h := md5.New()</span><br><span class="line"><span class="keyword">if</span> _, err := io.Copy(h, f); err != <span class="literal">nil</span> &#123;</span><br><span class="line">    log.Fatal(err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">"%x"</span>, h.Sum(<span class="literal">nil</span>))</span><br></pre></td></tr></table></figure>
<h3 id="随机数生成-rand"><a href="#随机数生成-rand" class="headerlink" title="随机数生成 rand"></a>随机数生成 rand</h3><ul>
<li><p>在Linux上使用<a href="http://man7.org/linux/man-pages/man2/getrandom.2.html" target="_blank" rel="noopener">getrandom(2)</a> 否则从/dev/urandom获取。</p>
</li>
<li><p>By default, getrandom() draws entropy from the urandom source (i.e.,<br> the same source as the /dev/urandom device).  This behavior can be<br> changed via the flags argument.</p>
</li>
<li><p>OpenBSD 使用getentropy(2)</p>
</li>
<li><p>其它Unix-like systems从/dev/urandom生成</p>
</li>
<li><p>Windows上使用CryptGenRandom API生成</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nonce := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">12</span>)</span><br><span class="line">io.ReadFull(rand.Reader, nonce)</span><br><span class="line"></span><br><span class="line">rand.Read(b)<span class="comment">//此方法等价于上面的调用。</span></span><br></pre></td></tr></table></figure>
<h3 id="块加密算法-rc4"><a href="#块加密算法-rc4" class="headerlink" title="块加密算法 rc4"></a>块加密算法 rc4</h3><ul>
<li>不安全的加密算法，不建议使用，这个是加密算法最早用在流式加密中。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ciper, err := rc4.NewCipher([]<span class="keyword">byte</span>(<span class="string">"HelloWorld"</span>))</span><br><span class="line"><span class="keyword">if</span> <span class="literal">nil</span> != err &#123;</span><br><span class="line">    <span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">plaintext := <span class="string">"RC4AAAAAAAAAA"</span></span><br><span class="line">buffer := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(plaintext))</span><br><span class="line">ciper.XORKeyStream(buffer, []<span class="keyword">byte</span>(plaintext))</span><br><span class="line">fmt.Println(buffer)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/02/关于Openresty的一些事情/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/02/关于Openresty的一些事情/" itemprop="url">
                  关于Openresty的一些事情
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-02 17:46:30 / 修改时间：18:24:44" itemprop="dateCreated datePublished" datetime="2018-11-02T17:46:30+08:00">2018-11-02</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="在对Openresty这块理解很初级的时候，写的一些脚本存在的低级错误。"><a href="#在对Openresty这块理解很初级的时候，写的一些脚本存在的低级错误。" class="headerlink" title="在对Openresty这块理解很初级的时候，写的一些脚本存在的低级错误。"></a>在对Openresty这块理解很初级的时候，写的一些脚本存在的低级错误。</h3><ul>
<li><p>把一些状态存储在lua的对象中，在收到请求的时候把对象内的值修改。这个操蛋的做法有什么问题？</p>
<ol>
<li><p>这么做，当前你只有一个nginx工作进程，并且lua_code_cache on;的时候，居然是可以用的。</p>
</li>
<li><p>并且在Window环境下，你会发现大部分情况都是居然可以用的。</p>
</li>
<li><p>在多个进程的情况下，你处理请求的进程只是其中一个，在修改对应的变量的时候，只会修改掉接收到请求的进程中的Lua对象值。这个时候就会出现，有的请求返回的值是正确的，有的不正确。</p>
</li>
<li><p>在代码缓存是off的时候，每次都会去重新载入代码文件，行为也会存在问题。</p>
<blockquote>
<p>所以针对可变的配置内容，不要写在lua文件中，nginx在尝试写入文件的时候，往往都会遇到权限问题，导致不能更新，因此对于动态配置的信息，存储到redis或者其它数据库中。如果实在不想加入数据库。那么可以存储到nginx的共享内存中去。</p>
</blockquote>
</li>
</ol>
</li>
<li><p>在Window下ngx.worker.id()的值都是0值。</p>
<ol>
<li><p>如果定时任务，只在一个进程中执行即可，如果多个进程会导致多次执行。</p>
<blockquote>
<p>第一版本：</p>
</blockquote>
</li>
<li><p>在共享内存中存储pid的标志位，只有第一个设置共享内存的进程执行后续的定时任务。后续的进行运行到此代码的时候，获取pid标志位存在的，就退出，这个也是有毛病的。</p>
</li>
<li><p>因为当我们去执行nginx -s reload的时候，共享内存的值是存在的，这个就会导致定时任务后续就不再执行了。</p>
<blockquote>
<p>第二版本：</p>
</blockquote>
</li>
<li><p>因为nginx的多个进程启动速度是比较快的。通过设置一个时间到共享内存中。通过判断时间间隔小于5秒的值全部退出掉。</p>
<blockquote>
<p>第三版本:</p>
</blockquote>
</li>
<li><p>没有了，如果有希望大神发个邮件给我，在此先感谢了。</p>
</li>
</ol>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/11/02/Lua编译/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/02/Lua编译/" itemprop="url">
                  Lua编译
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-02 13:39:02 / 修改时间：14:04:16" itemprop="dateCreated datePublished" datetime="2018-11-02T13:39:02+08:00">2018-11-02</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h3><ul>
<li><p>下载源码解压，执行make linux</p>
</li>
<li><p>提示readline找不到，执行apt-get install libreadline-dev</p>
<img src="/2018/11/02/Lua编译/libreadline-dev.png">
</li>
<li><p>提示ncurses找不到，执行apt-get install libncurses5-dev</p>
<img src="/2018/11/02/Lua编译/ncurses.png"></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/10/31/MakeDown竖线转义符号/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/31/MakeDown竖线转义符号/" itemprop="url">
                  MakeDown竖线转义符号
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-10-31 13:54:32 / 修改时间：15:24:44" itemprop="dateCreated datePublished" datetime="2018-10-31T13:54:32+08:00">2018-10-31</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="在通过MakeDown显示表格效果的时候，当内容存在“-”符号，这个时候需要通过-amp-124来进行替换"><a href="#在通过MakeDown显示表格效果的时候，当内容存在“-”符号，这个时候需要通过-amp-124来进行替换" class="headerlink" title="在通过MakeDown显示表格效果的时候，当内容存在“|”符号，这个时候需要通过&amp;#124来进行替换"></a>在通过MakeDown显示表格效果的时候，当内容存在“|”符号，这个时候需要通过<font color="#FF0000" size="3" face="微软雅黑">&amp;#124</font>来进行替换</h3><ul>
<li>例如：<h4 id="2018-10-31-耗时统计结果"><a href="#2018-10-31-耗时统计结果" class="headerlink" title="2018-10-31 耗时统计结果"></a>2018-10-31 耗时统计结果</h4></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 服务名称 | 应用名称 | 类型 | TRACEID | 消耗时间 |</span><br><span class="line">| ------- | ------- | ---- | ------- | ------- |</span><br><span class="line">| /admin_api&amp;#124;app.get_readytask.V2.0 | container_01 | http | 0AC93E771539590210225000606AC0 | 323 |</span><br><span class="line">| /admin_api&amp;#124;app.get_readytask.V2.0 | container_01 | http | 0AC93E771539590210225000606AC0 | 323 |</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="/2018/10/31/Foxmail密码查看/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ideath@operatorworld.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ewkoll">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/10/31/Foxmail密码查看/" itemprop="url">
                  Foxmail密码查看
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-10-31 13:43:39" itemprop="dateCreated datePublished" datetime="2018-10-31T13:43:39+08:00">2018-10-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-03-25 16:38:50" itemprop="dateModified" datetime="2019-03-25T16:38:50+08:00">2019-03-25</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Foxmail忘记密码"><a href="#Foxmail忘记密码" class="headerlink" title="Foxmail忘记密码"></a>Foxmail忘记密码</h3><p>Foxmail的密码文件存储于Foxmail 7.2\Storage\用户目录\Accounts下面，内部的是加密的，找些星号查看工具来看比较麻烦的。</p>
<ul>
<li><p>SMTP服务的认证方式plain那么只需要通过WireShark就可以看到明文密码。</p>
  <img src="/2018/10/31/Foxmail密码查看/Foxmail_passwd.png">
</li>
<li><p>Login认证方式，只是把密码进行Base64编码处理</p>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ideath@operatorworld.com</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">22</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright"> &copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ideath@operatorworld.com</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Muse</a> v6.4.2</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.2"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.2"></script>



  



  










  





  

  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
